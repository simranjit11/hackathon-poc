# Story 2.3: Elicitation UI Rendering (Web)

**Status:** Draft

---

## Story

**As a** web banking customer  
**I want to** see clear prompts for required confirmations  
**So that** I can complete payment authorization

---

## Acceptance Criteria

1. Client receives elicitation schema via LiveKit data channel
2. Client renders appropriate UI based on elicitation type (OTP, confirmation, form)
3. OTP input shows 6-digit code entry field
4. Confirmation dialog shows payment details with confirm/cancel buttons
5. Form renders multiple fields with validation
6. Payment details are displayed clearly (amount, payee, account - masked)
7. Client validates user input before submission
8. Client sends elicitation response via LiveKit data channel

---

## Tasks / Subtasks

- [ ] Task 1: Data Channel Elicitation Handler (AC: 1)
  - [ ] Extend `useDataChannel.ts` hook to handle elicitation messages
  - [ ] Parse elicitation schema from data channel
  - [ ] Route to appropriate UI component
  - [ ] Handle elicitation status updates

- [ ] Task 2: OTP Input Component (AC: 3)
  - [ ] Create `OTPInput` component
  - [ ] 6-digit code entry with auto-focus
  - [ ] Input validation (numbers only, 6 digits)
  - [ ] Show error messages for invalid input
  - [ ] Handle timeout countdown display

- [ ] Task 3: Confirmation Dialog Component (AC: 4, 6)
  - [ ] Create `ConfirmationDialog` component
  - [ ] Display payment details (masked)
  - [ ] Show amount, payee, account clearly
  - [ ] Confirm and Cancel buttons
  - [ ] Accessible keyboard navigation

- [ ] Task 4: Form Component (AC: 5)
  - [ ] Create `ElicitationForm` component
  - [ ] Render fields based on schema
  - [ ] Implement field validation
  - [ ] Show validation errors
  - [ ] Handle form submission

- [ ] Task 5: Input Validation (AC: 7)
  - [ ] Validate OTP format (6 digits)
  - [ ] Validate form fields per schema
  - [ ] Show client-side validation errors
  - [ ] Prevent invalid submissions

- [ ] Task 6: Response Submission (AC: 8)
  - [ ] Format elicitation response payload
  - [ ] Send via LiveKit data channel
  - [ ] Handle submission errors
  - [ ] Show loading state during submission

---

## Dev Notes

### Previous Story Insights
- Elicitation state management exists (Story 2.2)
- Data channel infrastructure needed

### Architecture References
[Source: docs/architecture.md#elicitation-architecture]

**Elicitation Schema:**
```typescript
interface ElicitationRequest {
  type: "elicitation";
  elicitation_id: string;
  elicitation_type: "otp" | "confirmation" | "form";
  schema: { fields: Array<ElicitationField> };
  context: { amount, payee, account };
}
```

**Platform Requirements:**
- Web: OTP-based authentication only
- No biometric requirement

### Existing Codebase Context

**Current Implementation:**
- No elicitation UI exists
- `useDataChannel.ts` hook doesn't exist yet
- Need to build elicitation components

**Files to Create:**
- `agent-starter-react/components/app/elicitation/OTPInput.tsx`
- `agent-starter-react/components/app/elicitation/ConfirmationDialog.tsx`
- `agent-starter-react/components/app/elicitation/ElicitationForm.tsx`
- `agent-starter-react/hooks/useDataChannel.ts`
- `agent-starter-react/hooks/useElicitation.ts`

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-XX | 1.0 | Initial story creation | Scrum Master |

---

## Dev Agent Record

### Agent Model Used
_To be filled by Dev Agent_

### Debug Log References
_To be filled by Dev Agent_

### Completion Notes List
_To be filled by Dev Agent_

### File List
_To be filled by Dev Agent_

---

## QA Results
_To be filled by QA Agent_

